<!DOCTYPE html>
<html lang="en">
<head>
  <title>kamus</title>
  
<style>html{width:100%;font-size:18px;line-height:1;-webkit-font-smoothing:antialiased!important;-moz-osx-font-smoothing:grayscale!important;text-rendering:optimizeLegibility!important;-webkit-tap-highlight-color:transparent;height:100%;min-height:100%;margin:0;padding:0;font-size:100%;background-color:#fff;color:#000;font-family:-apple-system,BlinkMacSystemFont,Roboto,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}code,pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Roboto Mono,Courier,monospace}body{width:100%;margin:0;padding:0;font-size:18px;line-height:1.5;min-height:100%;display:flex;flex-direction:column;background-color:#fff}#wrapper{background-color:#fff;max-width:100%;clear:both;overflow-x:hidden;flex:1 0 auto;margin:0;margin-left:240px}.sidebar-collapsed #wrapper{margin-left:0}#content,.footer{padding-left:.2em;margin:0 auto;padding:0 4px;width:calc(100% - 8px);max-width:50em}#content{padding-top:1em;min-height:calc(100vh - 4em)}#navbar{position:fixed;top:0;width:calc(100% - 240px);padding:2px 0;margin-left:1px;background-color:#fff;border-bottom:1px solid rgba(0,0,0,.1);display:flex;justify-content:space-between}.sidebar-collapsed #navbar{width:100%;margin-left:0}#navbar-title>a{font-weight:700;font-size:20px;padding:0 4px;vertical-align:middle}#navbar-title>a,#github>a{text-decoration:none}#sidebar-toggle{color:#000;cursor:pointer;padding:1px .5em;padding-bottom:0;user-select:none}#github{padding:0 .5em}#github img{height:1.4em;width:1.4em;vertical-align:middle}#sidebar{height:100%;position:fixed;display:flex;flex-direction:column;width:240px;border-right:1px solid rgba(0,0,0,.1);background-color:#fafafa}.sidebar-collapsed #sidebar{display:none}#sidebar-logo{padding:16px;padding-bottom:10px}#sidebar-title{display:none;margin-top:-16px;padding-right:37px;margin-bottom:10px;text-align:center;text-decoration:none;font-size:24px;font-weight:700}#sidebar li.active-entry :first-child,#sidebar li.active :first-child{font-weight:700}#sidebar li.active-entry :first-child{color:#000}a{color:#1f28f0}#content img{max-width:100%}hr{background:#333;border:1px solid #333}pre{background-color:#f3f4f4!important;overflow-x:auto;border-radius:5px;padding:.5em;font-size:85%}code{background-color:#f3f4f4;border-radius:3px;padding:.1em .4em;font-size:85%}pre code{background-color:transparent;padding:0;font-size:100%}.footer{text-align:center}.footer>*{font-size:.6em;line-height:1}.hanchor{font-size:100%;visibility:hidden;font-size:.5em;vertical-align:middle;text-decoration:none!important}h1:hover a,h2:hover a,h3:hover a,h4:hover a{visibility:visible}#content ul{padding-left:1.75em}#content ul ul{padding-left:1em}#sidebar ul ul{padding-left:1.25em}@media(max-width:50em){#content{font-size:16px}#wrapper{margin-left:0}#wrapper #navbar{margin-left:241px}.sidebar-collapsed #wrapper #navbar{margin-left:0}#content ul{padding-left:1.5em}}</style>

  
<script>function toggleSidebar(){if(document.body.classList.contains('sidebar-collapsed')){window.localStorage.setItem('sidebar-collapsed','false');showSideBar();}else{window.localStorage.setItem('sidebar-collapsed','true');hideSideBar();}}
function showSideBar(){document.body.classList.remove('sidebar-collapsed');}
function hideSideBar(){document.body.classList.add('sidebar-collapsed');}
function getWidth(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth);}
var oldWidth;document.addEventListener("DOMContentLoaded",function(){var manualCollapsed=window.localStorage.getItem('sidebar-collapsed');var width=getWidth();if(width>900&&(manualCollapsed=='false'||manualCollapsed==null)){showSideBar();}
oldWidth=width;window.addEventListener("resize",function(){var width=getWidth();if(oldWidth==width){oldWidth=width;return;}
oldWidth=width;if(width<=900){hideSideBar();}else{var manualCollapsed=window.localStorage.getItem('sidebar-collapsed');if(manualCollapsed=='false'||manualCollapsed==null){showSideBar();}}});});</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#2d89ef">
  <meta name="theme-color" content="#ffffff">
</head>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-3743375-31"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-3743375-31');
</script>
<body ontouchstart="return true" class="sidebar-collapsed">
<div id="sidebar">
  <a href="https://kamus.soluto.io" id="sidebar-logo"><img src="/logo/logo.png" width="60%" alt="kamus logo"/></a>
  <div style="background-color: rgba(0, 0, 0, 0.1); width: 100%; height: 1px"></div>
  <ul>
    
    
      
        
          <li class="">
            <a href="/">
              
              <span>Home</span>
            </a>
          </li>
        
      
    
      
        <li class="active"><span>User Guide</span></li>
        <ul class="sub-menu">
          
            <li class="">
              <a href="/docs/user/quick-start/">Quick Start</a>
            </li>
          
            <li class="">
              <a href="/docs/user/install/">Installing Kamus</a>
            </li>
          
            <li class="active-entry">
              <a href="/docs/user/crd/">Creating Kubernetes Secrets</a>
            </li>
          
            <li class="">
              <a href="/docs/user/known-issues/">Known Issues</a>
            </li>
          
            <li class="">
              <a href="/docs/user/changelog/">Changelog</a>
            </li>
          
        </ul>
      
    
      
        <li class=""><span>Contributing</span></li>
        <ul class="sub-menu">
          
            <li class="">
              <a href="/docs/contributing/getting-started/">Getting Started</a>
            </li>
          
            <li class="">
              <a href="/docs/contributing/roadmap/">Roadmap</a>
            </li>
          
        </ul>
      
    
      
        
      
    
      
        <li class=""><span>Threat Modeling</span></li>
        <ul class="sub-menu">
          
            <li class="">
              <a href="/docs/threatmodeling/architecture/">Architecture</a>
            </li>
          
            <li class="">
              <a href="/docs/threatmodeling/threats_controls/">Threats and Controls</a>
            </li>
          
            <li class="">
              <a href="/docs/threatmodeling/security/">Reporting Security Issues</a>
            </li>
          
        </ul>
      
    
  </ul>
</div>
<div id="wrapper"><div id="navbar">
  <span id="sidebar-toggle" onclick="toggleSidebar()">&#9776;</span><span id="navbar-title"><a href="https://kamus.soluto.io">kamus</a></span><span id="github"><a href="https://github.com/soluto/kamus"><img alt="github" title="github" src="/third_party/GitHub-Mark-120px-plus.png"></a></span>
</div>


<div id="content"><h1 id="custom-resource-descriptor-support">Custom Resource Descriptor Support<a href="#custom-resource-descriptor-support" class="hanchor" ariaLabel="Anchor"> ðŸ”—&#xFE0E;</a> </h1>
<p>Kamus supports also creating native Kubernetes secrets from an object called KamusSecret.
KamusSecret is very similar to Secret, with one small difference - all the items in it are encrypted.
Using KamusSecret allows to use Kamus with applications that requires native Kubernetes secrets - for example, TLS secrets.</p>
<h2 id="usage">Usage<a href="#usage" class="hanchor" ariaLabel="Anchor"> ðŸ”—&#xFE0E;</a> </h2>
<p>KamusSecret works very similary to regular secret encryption flow with Kamus.
The encrypted data is represented in a format that is identical to regular <a href="(https://kubernetes.io/docs/concepts/configuration/secret/)">Kubernetes Secrets</a>.
Kamus will create an identical secret with the decrypted content.</p>
<p>To encrypt the data, start by deciding to which namespace and which service account you&rsquo;re encrypting it.
The service account does not have to exist or used by the pod consuming the secret.
It just used for expressing who can consume this encrypted secret.
Use the <a href="https://github.com/Soluto/kamus/blob/master/cli/README.md">CLI</a> to encrypt the data:</p>
<pre><code>kamus-cli encrypt 
  --secret super-secret \\ 
  --service-account kamus-example-sa \\
  --namespace default \\
  --kamus-url &lt;Kamus URL&gt;
</code></pre><p>Now that you have the data encrypted, create a KamusSecret object, using the following manifest:</p>
<pre><code>apiVersion: &quot;soluto.com/v1alpha2&quot;
kind: KamusSecret
metadata:
  name: my-tls-secret       //This will be the name of the secret
  namespace: default        //The secret and KamusSecret live in this namespace
type: TlsSecret             //The type of the secret that will be created
stringData:                 //Put here all the encrypted data, that will be stored (decrypted) on the secret data
  key: J9NYLzTC/O44DvlCEZ+LfQ==:Cc9O5zQzFOyxwTD5ZHseqg==
data:                       //Put here base64 encoded data (usually, binary data like private keys in der format) encrypted (e.g. encrypt the value after base64 encoding it)
  key2: J9NYLzTC/O44DvlCEZ+LfQ==:Cc9O5zQzFOyxwTD5ZHseqg== 
serviceAccount: some-sa     //The service account used for encrypting the data
propagateAnnotations: true  //Opt-in for propagating Annotations from KamusSecret to Secret (default is false)
</code></pre><p>And finally, create the KamusSecret using:</p>
<pre><code>kubectl apply -f kamussecret.yaml
</code></pre><p>And after a few seconds you&rsquo;ll see the new secret created:</p>
<pre><code>$ kubectl get secrets
NAME                                       TYPE                                  DATA   AGE
default-token-m6whl                        kubernetes.io/service-account-token   3      1d
my-tls-secret                              TlsSecret                             1      5s
</code></pre><h2 id="migrating-from-previous-version">Migrating from previous version<a href="#migrating-from-previous-version" class="hanchor" ariaLabel="Anchor"> ðŸ”—&#xFE0E;</a> </h2>
<p>To migrate from <code>v1alpha1</code> to <code>v1alpha2</code> all you need to do is:</p>
<ul>
<li>Change the key <code>data</code> to <code>stringData</code></li>
<li>Change the <code>apiVersion</code> to <code>&quot;soluto.com/v1alpha2&quot;</code></li>
</ul>
<h2 id="known-limitation">Known limitation<a href="#known-limitation" class="hanchor" ariaLabel="Anchor"> ðŸ”—&#xFE0E;</a> </h2>
<p>This is the alpha release of this feature, so not all functionality is supported.
The current known issues:</p>
<ul>
<li>There is no validation - so if you forgot to add mandatory keys to the KamusSecret objects, it will not be created properly.</li>
</ul>
</div>
<div class="footer">
  <p class="copyright">Â© 2020 Soluto by Asurion | Documentation Distributed under <a class="nowrap" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></p>
  <p>Last Updated on 2019-09-09 14:45:35 &#43;0300 &#43;0300 in <span id="commit"><a href="https://github.com/Soluto/Kamus/commit/5c7be1cfe8343b8084b9a8a6d49c9e84e6efc8df">5c7be1c</a></span></p>
</div>
</div>
</body>
</html>
